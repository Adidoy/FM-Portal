@model PUPFMIS.Models.PPMPViewModel

@{
    ViewBag.Title = "Project Procurement Plans";
    ViewBag.Description = "Details";
    Layout = "~/Views/Shared/_BodyLayout.cshtml";
}

@section BreadCrumb {
    <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="/"><i class="fa fa-list"></i>&nbsp;@Html.ActionLink("PUP-FM Portal", "index", "Home", new { Area = "" }, null)</a></li>
        <li class="breadcrumb-item">@Html.ActionLink("Dashboard", "dashboard", "ProjectProcurementManagementPlans", new { Area = "end-users" })</li>
        <li class="breadcrumb-item">PPMP Details</li>
    </ol>
}

@section Header {
    <div class="col-md-12 text-right">
        <h1 class="card-title"><i class="fa fa-bookmark"></i>&nbsp; @Model.Header.ReferenceNo<span>&nbsp;:&nbsp;</span>@Model.Header.Classification</h1>
    </div>
}

<div class="card card-info">
    <div class="card-header">
        <h3 class="card-title">PPMP Information</h3>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.ReferenceNo, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-id-badge"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.ReferenceNo, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.ReferenceNo, disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.ReferenceNo, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.FiscalYear, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.FiscalYear, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.FiscalYear, disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.FiscalYear, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.UACS, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-folder"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.UACS, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.UACS, disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.UACS, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.Classification, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-book"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.Classification, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.Classification, disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.Classification, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.Status, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-comment-alt"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.Status, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.Status.GetAttribute<System.ComponentModel.DataAnnotations.DisplayAttribute>().Name, disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.Status, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.PPMPType, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-align-justify"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.PPMPType, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.PPMPType.GetAttribute<System.ComponentModel.DataAnnotations.DisplayAttribute>().Name, disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.PPMPType, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.CreatedAt, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-calendar-alt"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.CreatedAt, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size: 100%", Value = Model.Header.CreatedAt.ToString("dd MMMM yyyy hh:mm tt"), disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.CreatedAt, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-12">
                <div class="form-group">
                    @Html.LabelFor(model => model.Header.EstimatedBudget, htmlAttributes: new { @class = "control-label" })
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-coins"></i></span>
                        </div>
                        @Html.EditorFor(model => model.Header.EstimatedBudget, new { htmlAttributes = new { @class = "form-control form-control-sm", style = "font-size:100%; text-align:right;", Value = Model.Header.EstimatedBudget.ToString("C", new System.Globalization.CultureInfo("en-ph")), disabled = "disabled" } })
                    </div>
                    @Html.ValidationMessageFor(model => model.Header.EstimatedBudget, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
    </div>
</div>
<div class="card card-info">
    <div class="card-header">
        <h3 class="card-title">PPMP Items</h3>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-sm-12">
                <table class="table table-striped table-hover" id="ppmpDetails">
                    <thead>
                        <tr>
                            <th width="35%" style="text-align:center; vertical-align:middle">Item Name</th>
                            <th width="10%" style="text-align:center; vertical-align:middle">Status</th>
                            <th width="10%" style="text-align:center; vertical-align:middle">Total Qty. for the Year</th>
                            <th width="20%" style="text-align:center; vertical-align:middle">Estimated Budget</th>
                            <th width="25%" style="text-align:center; vertical-align:middle">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Details)
                        {
                            <tr>
                                <td style="text-align:left; vertical-align:middle;">
                                    <b>@Html.DisplayFor(d => item.ItemFullName)</b>
                                </td>
                                <td style="text-align:center; vertical-align:middle;">
                                    @if (item.NoOfAccepted > 0)
                                    {
                                        <span class="badge bg-success p-1 mb-1" style="font-size:100%; width:179px">@Html.DisplayFor(modelItem => item.NoOfAccepted) Project Item Accepted</span>
                                        <br />
                                    }
                                    @if (item.NoOfForRevision > 0)
                                    {
                                        <span class="badge bg-warning p-1 mb-1" style="font-size:100%; width:179px">@Html.DisplayFor(modelItem => item.NoOfForRevision) Project Item For Revision</span>
                                        <br />
                                    }
                                    @if (item.NoOfNotAccepted > 0)
                                    {
                                        <span class="badge bg-danger p-1 mb-1" style="font-size:100%; width:179px">@Html.DisplayFor(modelItem => item.NoOfNotAccepted) Project Item Not Accepted</span>
                                    }
                                </td>
                                <td style="text-align:center; vertical-align:middle;">
                                    @Html.DisplayFor(d => item.TotalQty)
                                </td>
                                <td style="text-align:right; vertical-align:middle;">
                                    @( item.EstimatedBudget.ToString("C", new System.Globalization.CultureInfo("en-ph")) )
                                </td>
                                <td style="text-align:center; vertical-align:middle;">
                                    <button type="button" class="btn btn-sm btn-primary" onclick="window.location = '@Url.Action("item-details", "ProjectProcurementManagementPlans", new { Area = "end-users", ReferenceNo = Model.Header.ReferenceNo, ItemCode = item.ItemCode })'"><i class="fa fa-eye"></i> View Details</button>
                                </td>
                            </tr>
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" style="text-align:right; vertical-align:middle;">
                                <h6><b>Total Estimated Budget:</b></h6>
                            </td>
                            <td style="text-align:right; vertical-align:middle;">
                                <h6><b>@( Model.Details.Sum(d => d.EstimatedBudget).ToString("C", new System.Globalization.CultureInfo("en-ph")) )</b></h6>
                            </td>
                            <td style="text-align:right; vertical-align:middle;"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="card card-info">
    <div class="card-header">
        <h3 class="card-title">Milestones</h3>
    </div>
    <div class="card-body">
        <div class="card-body table-responsive p-sm-0">
            <table class="table table-striped table-bordered table-hover" id="ppmpListOriginal">
                <thead>
                    <tr>
                        <th width="60%" rowspan="2" style="text-align:center; vertical-align:middle">Item</th>
                        <th width="40%" colspan="12" style="text-align:center; vertical-align:middle">Schedule/Milestones</th>
                    </tr>
                    <tr>
                        <th style="text-align:center; vertical-align:middle">JAN</th>
                        <th style="text-align:center; vertical-align:middle">FEB</th>
                        <th style="text-align:center; vertical-align:middle">MAR</th>
                        <th style="text-align:center; vertical-align:middle">APR</th>
                        <th style="text-align:center; vertical-align:middle">MAY</th>
                        <th style="text-align:center; vertical-align:middle">JUN</th>
                        <th style="text-align:center; vertical-align:middle">JUL</th>
                        <th style="text-align:center; vertical-align:middle">AUG</th>
                        <th style="text-align:center; vertical-align:middle">SEP</th>
                        <th style="text-align:center; vertical-align:middle">OCT</th>
                        <th style="text-align:center; vertical-align:middle">NOV</th>
                        <th style="text-align:center; vertical-align:middle">DEC</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Details)
                    {
                        <tr>
                            <td align="left">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <b>@Html.DisplayFor(d => item.ItemFullName)</b>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-5">
                                        <b>Total Quantity</b>
                                    </div>
                                    <div class="col-sm-7">
                                        :&nbsp;@Html.DisplayFor(d => item.TotalQty)
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-5">
                                        <b>Unit Cost</b>
                                    </div>
                                    <div class="col-sm-7">
                                        :&nbsp;@( item.UnitCost.ToString("C", new System.Globalization.CultureInfo("en-ph")) )
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-5">
                                        <b>Estimated Budget</b>
                                    </div>
                                    <div class="col-sm-7">
                                        :&nbsp;@( item.EstimatedBudget.ToString("C", new System.Globalization.CultureInfo("en-ph")) )
                                    </div>
                                </div>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.JANMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.JANMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.FEBMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.FEBMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.MARMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.MARMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.APRMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.APRMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.MAYMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.MAYMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.JUNMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.JUNMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.JULMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.JULMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.AUGMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.AUGMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.SEPMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.SEPMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.OCTMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.OCTMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.NOVMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.NOVMilestone</b>
                            </td>
                            <td style="text-align:center; vertical-align:middle; @( item.DECMilestone != string.Empty ? "background-color:yellow;" : "background-color:none" )">
                                <b>@item.DECMilestone</b>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

    </div>
    <div class="card-footer">
        <div class="row" style="font-size:10pt; color:red;">
            <div class="col-sm-12">
                <b>LEGEND:</b>
            </div>
        </div>
        <div class="row" style="font-size:9pt; color:red;">
            <div class="col-sm-6">
                <div class="row">
                    <div class="col-sm-2">
                        EPA-OCT 
                    </div>
                    <div class="col-sm-1">
                        -
                    </div>
                    <div class="col-sm-9">
                        Early Procurement Activities Starting OCT @(Model.Header.FiscalYear - 1)
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        EPA-NOV
                    </div>
                    <div class="col-sm-1">
                        -
                    </div>
                    <div class="col-sm-9">
                        Early Procurement Activities Starting NOV @(Model.Header.FiscalYear - 1)
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        EPA-DEC
                    </div>
                    <div class="col-sm-1">
                        -
                    </div>
                    <div class="col-sm-9">
                        Early Procurement Activities Starting DEC @(Model.Header.FiscalYear - 1)
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="row">
                    <div class="col-sm-2">
                        PRPC
                    </div>
                    <div class="col-sm-1">
                        -
                    </div>
                    <div class="col-sm-9">
                        P/R Preparation / Pre-Procurement Conference
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        PRAC
                    </div>
                    <div class="col-sm-1">
                        -
                    </div>
                    <div class="col-sm-9">
                        Procurement Activities
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-2">
                        DRIS
                    </div>
                    <div class="col-sm-1">
                        -
                    </div>
                    <div class="col-sm-9">
                        Delivery/Preparation of RIS
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section FormFooter{
    <div class="row">
        <div class="col-sm-12 text-right">
            <div class="form-group">
                <button type="button" class="btn btn-primary" onclick="window.location = '@Url.Action("print-ppmp", "ProjectProcurementManagementPlans", new { Area = "end-users" })'"><i class="fa fa-print"></i>&nbsp; Print PPMP</button>
                <button type="button" class="btn btn-danger" onclick="window.location = '@Url.Action("dashboard", "ProjectProcurementManagementPlans", new { area = "end-users" })'"><i class="fa fa-times-circle"></i>&nbsp; Back to Dashboard</button>
            </div>
        </div>
    </div>
}

<script type="text/javascript">
    $(function () {
        $('#ppmpDetails').DataTable({
            "paging": true,
            "lengthChange": true,
            "searching": true,
            "ordering": false,
            "info": true,
            "autoWidth": false,
        });
    });
</script>