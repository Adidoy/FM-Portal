@model PUPFMIS.Models.ProjectPlanVM

@{
    ViewBag.Title = "Items Basket";
    ViewBag.Description = "";
    Layout = "~/Views/Shared/_BodyLayout.cshtml";
}

@section BreadCrumb {
    <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="/"><i class="fa fa-dashboard"></i>@Html.ActionLink("PUP-FM Portal", "index", "Home")</a></li>
        <li class="breadcrumb-item">@Html.ActionLink("Dashboard", "dashboard", "ProjectPlans", new { area = "end-users" }, null)</li>
        <li class="breadcrumb-item">Basket</li>
    </ol>
}

@section Header {
    <div class="col-md-12 text-right">
        <h1 class="card-title"><i class="fa fa-bookmark"></i> Items Basket</h1>
    </div>
}

@using (Html.BeginForm("save-common-supplies", "Catalogue", FormMethod.Post, new { Area = "end-users" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(false, "", new { @class = "text-danger", style = "font-size: 12pt;" })
    @Html.HiddenFor(model => model.ProjectCode)
    <div class="row">
        <div class="col-sm-12">
            <h4>Line Items</h4>
            <hr />
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 pl-0 pr-0 ml-0 mr-0">
            <div class="card card-info card-outline">
                <div class="card-body">
                    <div class="card-body table-responsive p-sm-0">
                        <table class="table table-striped table-hover" id="basket">
                            <thead>
                                <tr>
                                    <th rowspan="2" width="45%" style="text-align:center; vertical-align:middle">Item and Specifications</th>
                                    <th colspan="3" style="text-align:center; vertical-align:middle">Quantity Requirement</th>
                                    <th rowspan="2" width="13%" style="text-align:center; vertical-align:middle">Unit Cost</th>
                                    <th rowspan="2" width="14%" style="text-align:center; vertical-align:middle">Estimated Budget</th>
                                    <th rowspan="2" width="15%" style="text-align:center; vertical-align:middle">Action</th>
                                </tr>
                                <tr>
                                    <th width="6%" colspan="2" style="text-align:center; vertical-align:middle">Distribution</th>
                                    <th width="7%" style="text-align:center; vertical-align:middle">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.NewItemProposals != null)
                                {
                                    for (var item = 0; item < Model.NewItemProposals.Count; item++)
                                    {
                                        <tr>
                                            <td style="text-align:justify; vertical-align: top;">
                                                @Html.HiddenFor(modelItem => Model.NewItemProposals[item].ItemCode)
                                                @Html.HiddenFor(model => Model.NewItemProposals[item].Remarks)
                                                <span style="font-size:12pt"><b>@Html.DisplayFor(modelItem => Model.NewItemProposals[item].ItemName) (<small><b>@Html.DisplayFor(modelItem => Model.NewItemProposals[item].ItemCode)</b></small>)</b></span>
                                                <br /><br />
                                                @Html.HiddenFor(modelItem => Model.NewItemProposals[item].ItemSpecifications)
                                                <b>@Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].ItemSpecifications)</b>
                                                <br />
                                                @Html.DisplayFor(modelItem => Model.NewItemProposals[item].ItemSpecifications)
                                                <br /><br />
                                                <b>@Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].IndividualUOMReference) : </b>@Html.DisplayFor(model => Model.NewItemProposals[item].IndividualUOMReference)
                                                <br />
                                                @Html.HiddenFor(modelItem => Model.NewItemProposals[item].UnitCost)
                                                <b>@Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].UnitCost) : </b>@( String.Format("{0:C}", Model.NewItemProposals[item].UnitCost) )
                                            </td>
                                            <td style="text-align:left; vertical-align:top;" width="1%">
                                                @if (Model.NewItemProposals[item].JanQty != 0 && Model.NewItemProposals[item].JanQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].JanQty)<span>:</span>
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].FebQty != 0 && Model.NewItemProposals[item].FebQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].FebQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].MarQty != 0 && Model.NewItemProposals[item].MarQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].MarQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].AprQty != 0 && Model.NewItemProposals[item].AprQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].AprQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].MayQty != 0 && Model.NewItemProposals[item].MayQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].MayQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].JunQty != 0 && Model.NewItemProposals[item].JunQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].JunQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].JulQty != 0 && Model.NewItemProposals[item].JulQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].JulQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].AugQty != 0 && Model.NewItemProposals[item].AugQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].AugQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].SepQty != 0 && Model.NewItemProposals[item].SepQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].SepQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].OctQty != 0 && Model.NewItemProposals[item].OctQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].OctQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].NovQty != 0 && Model.NewItemProposals[item].NovQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].NovQty)<span>:</span>
                                                                            <br />
                                                }
                                                @if (Model.NewItemProposals[item].DecQty != 0 && Model.NewItemProposals[item].DecQty != null)
                                                {
                                                    @Html.DisplayNameFor(modelItem => Model.NewItemProposals[item].DecQty)<span>:</span>
                                                }
                                            </td>
                                            <td style="text-align:right; vertical-align:top;" width="5%">
                                                @if (Model.NewItemProposals[item].JanQty != 0 && Model.NewItemProposals[item].JanQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].JanQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].JanQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].FebQty != 0 && Model.NewItemProposals[item].FebQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].FebQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].FebQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].MarQty != 0 && Model.NewItemProposals[item].MarQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].MarQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].MarQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].AprQty != 0 && Model.NewItemProposals[item].AprQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].AprQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].AprQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].MayQty != 0 && Model.NewItemProposals[item].MayQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].MayQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].MayQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].JunQty != 0 && Model.NewItemProposals[item].JunQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].JunQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].JunQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].JulQty != 0 && Model.NewItemProposals[item].JulQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].JulQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].JulQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].AugQty != 0 && Model.NewItemProposals[item].AugQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].AugQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].AugQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].SepQty != 0 && Model.NewItemProposals[item].SepQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].SepQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].SepQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].OctQty != 0 && Model.NewItemProposals[item].OctQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].OctQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].OctQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].NovQty != 0 && Model.NewItemProposals[item].NovQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].NovQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].NovQty)
                                                    <br />
                                                }
                                                @if (Model.NewItemProposals[item].DecQty != 0 && Model.NewItemProposals[item].DecQty != null)
                                                {
                                                    @Html.HiddenFor(modelItem => Model.NewItemProposals[item].DecQty)
                                                    @Html.DisplayFor(modelItem => Model.NewItemProposals[item].DecQty)
                                                }
                                            </td>
                                            <td style="text-align: center; vertical-align: top;">
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].TotalQty)
                                                @Html.DisplayFor(modelItem => Model.NewItemProposals[item].TotalQty)
                                            </td>
                                            <td style="text-align:right; vertical-align:top;">
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].UnitCost)
                                                @( String.Format("{0:C}", Model.NewItemProposals[item].UnitCost) )
                                            </td>
                                            <td style="text-align:right; vertical-align:top;">
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].ProposalType)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].InventoryType)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].Supplier1ID)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].Supplier1UnitCost)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].Supplier2ID)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].Supplier2UnitCost)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].Supplier3ID)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].Supplier3UnitCost)
                                                @Html.HiddenFor(m => Model.NewItemProposals[item].EstimatedBudget)
                                                @( String.Format("{0:C}", Model.NewItemProposals[item].EstimatedBudget) )
                                            </td>
                                            <td style="text-align: center; vertical-align: top;">
                                                <button type="button" style="width: 35px;" class="btn btn-sm btn-warning" onclick="window.location = '@Url.Action("update-basket-item", "Catalogue", new { ItemCode = Model.NewItemProposals[item].ItemCode, InventoryType = Model.NewItemProposals[item].InventoryType })'"><i class="fa fa-edit"></i></button>
                                                <button type="button" style="width: 35px;" class="btn btn-sm btn-danger" id="remove-btn" onclick="window.location.href = '@Url.Action("remove-basket-item", "Catalogue", new { ItemCode = Model.NewItemProposals[item].ItemCode })'"><i class="fa fa-times"></i></button>
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="5" align="right"><h5>Total Estimated Budget:</h5></td>
                                    <td align="right"><h5>@( string.Format("{0:C}", Model.NewItemProposals.Sum(d => d.EstimatedBudget)) )</h5></td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <br /><br />
    <div class="row">
        <div class="col-sm-12">
            <div class="form-group float-right">
                <button type="submit" class="btn btn-primary"><i class="fa fa-save"></i> Post Items to Project</button>
                <button type="button" class="btn btn-danger" onclick='window.location = "@Url.Action("view-item-catalogue", "Catalogue", new { Area = "end-users" })"'><i class="fa fa-arrow-circle-left"></i> Back to Catalogue</button>
            </div>
        </div>
    </div>
}

<script src="~/Scripts/adminlte/components/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">
    $(function () {
        $('#items').DataTable({
            "paging": true,
            "lengthChange": true,
            "searching": true,
            "ordering": false,
            "info": true,
            "autoWidth": false,
        });
    });
    $(function () {
        $('#basket').DataTable({
            "paging": true,
            "lengthChange": true,
            "searching": true,
            "ordering": false,
            "info": true,
            "autoWidth": false,
        });
    });
</script>
